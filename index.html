<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"> <!-- Added user-scalable=no for mobile -->
    <title>Wedding Windows 95</title>
    <link rel="stylesheet" href="style.css">
    <!-- Add a favicon -->
    <link rel="icon" href="icons/All [Without duplicates]/Windows logo (without text).ico" type="image/x-icon">
</head>
<body>
    <div class="desktop" id="desktop-area">
        <!-- Desktop Icons -->
        <div class="icon" id="invitation-icon" data-window-id="invitation-window">
            <img src="icons/All [Without duplicates]/Document with phone.ico" alt="Invitation Icon" class="icon-img">
            <div>Invitation.txt</div>
        </div>
        <div class="icon" id="outlook-icon" data-window-id="email-window">
            <img src="icons/All [Without duplicates]/Mail catalog.ico" alt="Email Icon" class="icon-img">
            <div>Fancy-Outlook</div>
        </div>
        <div class="icon" id="recycle-icon" data-window-id="recycle-window">
            <img src="icons/All [Without duplicates]/Recycle Bin with torned document and program.ico" alt="Recycle Bin Icon" class="icon-img" id="recycle-bin-image">
            <div>Recycle Bin</div>
        </div>
        <div class="icon" id="mycomputer-icon" data-window-id="mycomputer-window">
            <img src="icons/All [Without duplicates]/My Computer.ico" alt="My Computer Icon" class="icon-img">
            <div>My Computer</div>
        </div>
         <!-- Picture icons now primarily use openPicture via the generic viewer -->
        <div class="icon" id="picture1-icon" data-img-src="Photos/dworek2.jpg" data-img-title="separowo.jpg">
            <img src="icons/All [Without duplicates]/Drawing red picture.ico" alt="Picture 1 Icon" class="icon-img">
            <div>separowo.jpg</div>
        </div>
        <div class="icon" id="picture2-icon" data-img-src="Photos/my2.jpg" data-img-title="to_my.png">
            <img src="icons/All [Without duplicates]/Drawing green picture.ico" alt="Picture 2 Icon" class="icon-img">
            <div>to_my.png</div>
        </div>
        <div class="icon" id="folder-icon" data-window-id="folder-window">
            <img src="icons/All [Without duplicates]/Folder.ico" alt="Folder Icon" class="icon-img">
            <div>Photos</div>
        </div>
        <div class="icon" id="upload-icon" data-window-id="upload-window">
            <img src="icons/All [Without duplicates]/Upload cloud.ico" alt="Upload Icon" class="icon-img">
            <div>Send Media</div>
        </div>
        <div class="icon" id="gallery-icon" data-window-id="gallery-window">
            <img src="icons/All [Without duplicates]/Pictures.ico" alt="Gallery Icon" class="icon-img">
            <div>View Gallery</div>
        </div>
        <div class="icon" id="ie-icon" data-window-id="ie-widget">
            <img src="icons/explorer.png" alt="IE Icon" class="icon-img">
            <div>Internet Fun</div>
        </div>
        <div class="icon" id="notepad-icon" data-window-id="notepad-window">
            <img src="icons/All [Without duplicates]/Notepad.ico" alt="Notepad Icon" class="icon-img">
            <div>Notepad</div>
        </div>
        <div class="icon" id="minesweeper-icon" data-window-id="minesweeper-window">
            <!-- NOTE: Now opens the actual game -->
            <img src="icons/All [Without duplicates]/Game.ico" alt="Minesweeper Icon" class="icon-img">
            <div>Minesweeper</div>
        </div>
         <div class="icon" id="controlpanel-icon" data-window-id="controlpanel-window">
            <img src="icons/All [Without duplicates]/Controls.ico" alt="Control Panel Icon" class="icon-img">
            <div>Control Panel</div>
        </div>

        <!-- Application Windows -->

        <!-- Invitation Window -->
        <div class="window" id="invitation-window">
            <div class="title-bar">
                <img src="icons/All [Without duplicates]/Document with phone.ico" alt="Icon" class="title-bar-icon">
                <span>Invitation.txt</span>
                <div class="window-controls">
                    <button class="minimize-button button-border-raised">ˍ</button>
                    <button class="maximize-button button-border-raised">□</button>
                    <button class="close-button button-border-raised">✕</button>
                </div>
            </div>
            <div class="content">
                <h2 style="text-align: center;">Oliwia i Maks</h2>
                <h3 style="text-align: center;">serdecznie zapraszają</h3>
                <p style="text-align: center;">na uroczystość zawarcia związku małżeńskiego oraz przyjęcie weselne, które odbędą się</p>
                <h2 style="text-align: center;">3 sierpnia 2025 o godzinie 17:00 w Dworku Separowo</h2>
                <h4 style="text-align: center;">Separowo 8, 62-066 Separowo</h4>
                <p style="text-align: center;">Prosimy o potwierdzenie swojej obecności do 01.05.2025.</p>
                <p style="text-align: center;">
                    <button class="button-border-raised" onclick="sendEmail(true)">Confirm Attendance</button>
                    <button class="button-border-raised" style="margin-left: 10px;" onclick="sendEmail(false)">Decline Attendance</button>
                </p>
                <img src="Photos/my5.jpg" alt="Event Image" style="display:block; margin:10px auto; max-width:90%; max-height: 150px; border: 1px solid var(--win95-dark-gray);">
                <p style="text-align: center; margin-top: 15px;">Jak coś, prosimy o śmiałe odzywanie się!</p>
            </div>
            <div class="resizer resizer-n"></div><div class="resizer resizer-ne"></div><div class="resizer resizer-e"></div>
            <div class="resizer resizer-se"></div><div class="resizer resizer-s"></div><div class="resizer resizer-sw"></div>
            <div class="resizer resizer-w"></div><div class="resizer resizer-nw"></div>
        </div>

        <!-- Upload window -->
        <div class="window" id="upload-window">
            <div class="title-bar">
                <img src="icons/All [Without duplicates]/Upload cloud.ico" alt="Icon" class="title-bar-icon">
                <span>Send Media to NAS</span>
                <div class="window-controls">
                    <button class="minimize-button button-border-raised">ˍ</button>
                    <button class="maximize-button button-border-raised">□</button>
                    <button class="close-button button-border-raised">✕</button>
                </div>
            </div>
            <div class="content">
                <p>Select media files to upload to the shared wedding gallery:</p>
                <form id="upload-form" style="margin-top:10px;">
                    <input type="file" id="file-input" name="file" multiple accept="image/*,video/*">
                    <button type="button" class="button-border-raised" onclick="uploadMedia()">Send</button>
                </form>
                <div id="upload-status" style="margin-top: 15px; font-style: italic;"></div>
                <hr style="margin: 15px 0;">
                <p style="font-size:10px;"><strong>Note:</strong> This uses a Synology NAS backend. Ensure NAS_BASE_URL, username, and password are correctly configured in script.js for this feature to work. Target: /Public/WeddingUploads.</p>
            </div>
            <div class="resizer resizer-n"></div><div class="resizer resizer-ne"></div><div class="resizer resizer-e"></div>
            <div class="resizer resizer-se"></div><div class="resizer resizer-s"></div><div class="resizer resizer-sw"></div>
            <div class="resizer resizer-w"></div><div class="resizer resizer-nw"></div>
        </div>

        <!-- Gallery Window -->
        <div class="window" id="gallery-window">
          <div class="title-bar">
            <img src="icons/All [Without duplicates]/Pictures.ico" alt="Icon" class="title-bar-icon">
            <span>Shared Media Gallery</span>
            <div class="window-controls">
              <button class="minimize-button button-border-raised">ˍ</button>
              <button class="maximize-button button-border-raised">□</button>
              <button class="close-button button-border-raised">✕</button>
            </div>
          </div>
          <div class="content">
            <button class="button-border-raised" onclick="loadGallery()">Refresh Gallery</button>
            <div id="gallery-container" class="folder-grid content-border-sunken" style="margin-top: 10px; background: #e8e8e8; min-height: 150px;">
              <p>Click 'Refresh Gallery' to load media from NAS.</p>
            </div>
          </div>
          <div class="resizer resizer-n"></div><div class="resizer resizer-ne"></div><div class="resizer resizer-e"></div>
          <div class="resizer resizer-se"></div><div class="resizer resizer-s"></div><div class="resizer resizer-sw"></div>
          <div class="resizer resizer-w"></div><div class="resizer resizer-nw"></div>
        </div>

        <!-- Email Window -->
        <div class="window" id="email-window">
            <div class="title-bar">
                <img src="icons/All [Without duplicates]/Mail catalog.ico" alt="Icon" class="title-bar-icon">
                <span>Outlook Express - Wedding Edition</span>
                <div class="window-controls">
                    <button class="minimize-button button-border-raised">ˍ</button>
                    <button class="maximize-button button-border-raised">□</button>
                    <button class="close-button button-border-raised">✕</button>
                </div>
            </div>
            <div class="menu-bar">
              <div class="menu-item"><u>F</u>ile
                <div class="dropdown-menu">
                  <div class="dropdown-item" onclick="sendEmailMessage()"><u>S</u>end/Receive</div>
                  <div class="dropdown-item" onclick="closeWindow('email-window')">E<u>x</u>it</div>
                </div>
              </div>
              <div class="menu-item" onclick="alert('Edit menu not implemented for this demo.')"><u>E</u>dit</div>
              <div class="menu-item" onclick="alert('View menu not implemented for this demo.')"><u>V</u>iew</div>
              <div class="menu-item" onclick="alert('Help is on the way... eventually.')"><u>H</u>elp</div>
            </div>
            <div class="email-container">
                <div class="email-nav">
                    <div class="folder active" onclick="switchFolder('inbox', this)" id="folder-inbox"><img src="icons/All [Without duplicates]/Mail catalog.ico" alt="">Inbox</div>
                    <div class="folder" onclick="switchFolder('outbox', this)" id="folder-outbox"><img src="icons/All [Without duplicates]/Mail wizard.ico" alt="">Outbox</div>
                    <div class="folder" onclick="switchFolder('sent', this)" id="folder-sent"><img src="icons/All [Without duplicates]/Mail stamp (return).ico" alt="">Sent Items</div>
                    <div class="folder" onclick="switchFolder('spam', this)" id="folder-spam"><img src="icons/All [Without duplicates]/Mail (forbidden).ico" alt="">Junk Mail</div>
                </div>
                <div class="email-main">
                    <div class="email-list content-border-sunken" id="email-list"></div>
                    <div class="email-content content-border-sunken" id="email-content"><p style="padding: 20px; text-align: center;">Select an email.</p></div>
                </div>
            </div>
            <div class="resizer resizer-n"></div><div class="resizer resizer-ne"></div><div class="resizer resizer-e"></div>
            <div class="resizer resizer-se"></div><div class="resizer resizer-s"></div><div class="resizer resizer-sw"></div>
            <div class="resizer resizer-w"></div><div class="resizer resizer-nw"></div>
        </div>

        <!-- Help Window -->
        <div class="window" id="help-window">
          <div class="title-bar">
            <img src="icons/All [Without duplicates]/Help page.ico" alt="Icon" class="title-bar-icon">
            <span>Wedding Day Survival Guide</span>
            <div class="window-controls">
              <button class="minimize-button button-border-raised">ˍ</button>
              <button class="maximize-button button-border-raised">□</button>
              <button class="close-button button-border-raised">✕</button>
            </div>
          </div>
          <div class="content">
            <h2>Map to Dworek Separowo</h2>
            <img src="Photos/mapa1.png" alt="Map" style="display:block; margin-bottom:10px; max-width: 100%; border: 1px solid var(--win95-dark-gray);">
            <p><strong>Getting there:</strong> Follow signs for "Awesome Wedding"! GPS: 52.2115° N, 16.4020° E (approx). Listen for music.</p>
            <hr><h4>FAQs:</h4>
            <p><strong>Q: Dress code?</strong><br>A: "Fabulously retro" or "Comfortably chic". Win95 themes welcome!</p>
            <p><strong>Q: Song requests?</strong><br>A: Yes! 90s priority. Macarena = Clippy escort.</p>
            <p><strong>Q: Technical issue?</strong><br>A: Try turning it off and on again? (Contact the couple!)</p>
          </div>
          <div class="resizer resizer-n"></div><div class="resizer resizer-ne"></div><div class="resizer resizer-e"></div>
          <div class="resizer resizer-se"></div><div class="resizer resizer-s"></div><div class="resizer resizer-sw"></div>
          <div class="resizer resizer-w"></div><div class="resizer resizer-nw"></div>
        </div>

        <!-- My Computer Window -->
        <div class="window" id="mycomputer-window">
          <div class="title-bar">
            <img src="icons/All [Without duplicates]/My Computer.ico" alt="Icon" class="title-bar-icon">
            <span>My Computer</span>
            <div class="window-controls">
              <button class="minimize-button button-border-raised">ˍ</button>
              <button class="maximize-button button-border-raised">□</button>
              <button class="close-button button-border-raised">✕</button>
            </div>
          </div>
          <div class="content">
            <div class="drive-container">
                <div class="drive" data-drive-id="A" data-drive-name="3½ Floppy (A:)"><img src="icons/All [Without duplicates]/Drive (Floppy 3).ico" alt="Icon"><div>(A:)</div></div>
                <div class="drive" data-drive-id="C" data-drive-name="Local Disk (C:)"><img src="icons/All [Without duplicates]/Drive.ico" alt="Icon"><div>(C:)</div></div>
                <div class="drive" data-drive-id="D_Wedding" data-drive-name="Wedding Files (D:)"><img src="icons/All [Without duplicates]/Drive.ico" alt="Icon"><div>(D:) Wedding</div></div>
                <div class="drive" data-drive-id="E_CD" data-drive-name="CD-ROM Drive (E:)"><img src="icons/All [Without duplicates]/CD Drive.ico" alt="Icon"><div>(E:) CD-ROM</div></div>
                 <div class="drive" data-drive-id="controlpanel" data-drive-name="Control Panel" data-opens-window="controlpanel-window"><img src="icons/All [Without duplicates]/Controls.ico" alt="Icon"><div>Control Panel</div></div>
                <div class="drive" data-drive-id="printers" data-drive-name="Printers" data-opens-explorer="printers"><img src="icons/All [Without duplicates]/Printer (3D).ico" alt="Icon"><div>Printers</div></div>
            </div><hr>
            <p style="text-align: center; margin-top: 10px; font-size:11px;">System Properties: Pentium II 300MHz, 64MB RAM, Windows 95 Wedding Edition</p>
            <img src="Photos/cake.jpg" alt="Cake" style="display:block; margin: 5px auto; max-width:80%; max-height: 100px; border: 1px solid var(--win95-dark-gray);">
          </div>
          <div class="resizer resizer-n"></div><div class="resizer resizer-ne"></div><div class="resizer resizer-e"></div>
          <div class="resizer resizer-se"></div><div class="resizer resizer-s"></div><div class="resizer resizer-sw"></div>
          <div class="resizer resizer-w"></div><div class="resizer resizer-nw"></div>
        </div>

        <!-- Generic Explorer Window -->
        <div class="window" id="explorer-window">
          <div class="title-bar">
            <img src="icons/All [Without duplicates]/Folder (Open).ico" alt="Icon" class="title-bar-icon" id="explorer-title-icon">
            <span id="explorer-title-text">Explorer</span>
            <div class="window-controls">
              <button class="minimize-button button-border-raised">ˍ</button>
              <button class="maximize-button button-border-raised">□</button>
              <button class="close-button button-border-raised">✕</button>
            </div>
          </div>
          <div class="content" id="explorer-content" style="background-color: var(--win95-white);">
             <!-- Content added by JS --> <p>Select an item.</p>
          </div>
          <div class="resizer resizer-n"></div><div class="resizer resizer-ne"></div><div class="resizer resizer-e"></div>
          <div class="resizer resizer-se"></div><div class="resizer resizer-s"></div><div class="resizer resizer-sw"></div>
          <div class="resizer resizer-w"></div><div class="resizer resizer-nw"></div>
        </div>

        <!-- Picture Viewer Window (Generic) -->
        <div class="window" id="picture1-window">
          <div class="title-bar">
            <img src="icons/All [Without duplicates]/Picture.ico" alt="Icon" class="title-bar-icon">
            <span id="picture1-title">Image Viewer</span>
            <div class="window-controls">
              <button class="minimize-button button-border-raised">ˍ</button>
              <button class="maximize-button button-border-raised">□</button>
              <button class="close-button button-border-raised">✕</button>
            </div>
          </div>
          <div class="content image-content">
            <img id="picture1-image" src="" alt="Viewed Picture">
          </div>
          <div class="resizer resizer-n"></div><div class="resizer resizer-ne"></div><div class="resizer resizer-e"></div>
          <div class="resizer resizer-se"></div><div class="resizer resizer-s"></div><div class="resizer resizer-sw"></div>
          <div class="resizer resizer-w"></div><div class="resizer resizer-nw"></div>
        </div>

        <!-- Folder Window (Photos) -->
        <div class="window" id="folder-window">
          <div class="title-bar">
            <img src="icons/All [Without duplicates]/Folder.ico" alt="Icon" class="title-bar-icon">
            <span>Photos</span>
            <div class="window-controls">
              <button class="minimize-button button-border-raised">ˍ</button>
              <button class="maximize-button button-border-raised">□</button>
              <button class="close-button button-border-raised">✕</button>
            </div>
          </div>
          <div class="content">
            <div class="folder-grid">
              <div class="folder-item" onclick="openPicture('Photos/my1.jpg', 'O&M_1.jpg')"><img src="Photos/my1.jpg" alt="Thumb"><div>O&M_1.jpg</div></div>
              <div class="folder-item" onclick="openPicture('Photos/my3.jpg', 'O&M_3.jpg')"><img src="Photos/my3.jpg" alt="Thumb"><div>O&M_3.jpg</div></div>
              <div class="folder-item" onclick="openPicture('Photos/my5.jpg', 'O&M_5.jpg')"><img src="Photos/my5.jpg" alt="Thumb"><div>O&M_5.jpg</div></div>
              <div class="folder-item" onclick="openPicture('Photos/placeholder1.jpg', 'Placeholder_View.jpg')"><img src="Photos/placeholder1.jpg" alt="Thumb"><div>View.jpg</div></div>
              <div class="folder-item" onclick="openPicture('Photos/placeholder2.jpg', 'Placeholder_Relax.jpg')"><img src="Photos/placeholder2.jpg" alt="Thumb"><div>Relax.jpg</div></div>
              <div class="folder-item" onclick="openPicture('Photos/placeholder3.jpg', 'Placeholder_Smile.jpg')"><img src="Photos/placeholder3.jpg" alt="Thumb"><div>Smile.jpg</div></div>
            </div>
          </div>
          <div class="resizer resizer-n"></div><div class="resizer resizer-ne"></div><div class="resizer resizer-e"></div>
          <div class="resizer resizer-se"></div><div class="resizer resizer-s"></div><div class="resizer resizer-sw"></div>
          <div class="resizer resizer-w"></div><div class="resizer resizer-nw"></div>
        </div>

        <!-- Internet Explorer Window -->
        <div class="window" id="ie-widget">
            <div class="title-bar">
                <img src="icons/explorer.png" alt="Icon" class="title-bar-icon">
                <span>Internet Explorer - Wedding Edition</span>
                <div class="window-controls">
                    <button class="minimize-button button-border-raised">ˍ</button>
                    <button class="maximize-button button-border-raised">□</button>
                    <button class="close-button button-border-raised">✕</button>
                </div>
            </div>
            <div class="menu-bar">
              <div class="menu-item"><u>F</u>ile <div class="dropdown-menu"><div class="dropdown-item" onclick="closeWindow('ie-widget')">E<u>x</u>it</div></div></div>
              <div class="menu-item"><u>E</u>dit</div>
              <div class="menu-item"><u>V</u>iew</div>
              <div class="menu-item" id="ie-favorites-menu">F<u>a</u>vorites <div class="dropdown-menu" id="ie-favorites-dropdown"> <!-- Populated by JS --> </div></div>
              <div class="menu-item"><u>H</u>elp</div>
            </div>
            <div class="ie-toolbar">
                <button class="button-border-raised" onclick="ieGoBack()" title="Back" disabled>◀</button>
                <button class="button-border-raised" onclick="ieGoForward()" title="Forward" disabled>▶</button>
                <label for="ie-url">Address:</label>
                <input id="ie-url" type="text" placeholder="http://" onkeydown="if(event.key === 'Enter') ieGo()">
                <button class="button-border-raised" onclick="ieGo()">Go</button>
            </div>
            <div class="content ie-content">
                <iframe id="ie-iframe" src="about:blank" sandbox="allow-scripts allow-same-origin allow-forms allow-popups"></iframe>
            </div>
            <div class="ie-history">
                <label for="ie-history-select">History:</label>
                <select id="ie-history-select" onchange="ieHistorySelect()"><option value="">-- Visited Sites --</option></select>
            </div>
            <div class="resizer resizer-n"></div><div class="resizer resizer-ne"></div><div class="resizer resizer-e"></div>
            <div class="resizer resizer-se"></div><div class="resizer resizer-s"></div><div class="resizer resizer-sw"></div>
            <div class="resizer resizer-w"></div><div class="resizer resizer-nw"></div>
        </div>

        <!-- Recycle Bin Window -->
        <div class="window" id="recycle-window">
          <div class="title-bar">
            <img src="icons/All [Without duplicates]/Recycle Bin with torned document and program.ico" alt="Icon" class="title-bar-icon" id="recycle-window-title-icon">
            <span>Recycle Bin</span>
            <div class="window-controls">
              <button class="minimize-button button-border-raised">ˍ</button>
              <button class="maximize-button button-border-raised">□</button>
              <button class="close-button button-border-raised">✕</button>
            </div>
          </div>
          <div class="menu-bar">
            <div class="menu-item"><u>F</u>ile
                <div class="dropdown-menu"> <div class="dropdown-item" onclick="emptyRecycleBin()"><u>E</u>mpty Recycle Bin</div></div>
            </div>
            <div class="menu-item"><u>E</u>dit</div>
          </div>
          <div class="content content-border-sunken" style="background: var(--win95-white);">
             <ul id="recycle-bin-list"></ul> <!-- Items populated by JS -->
          </div>
          <div class="resizer resizer-n"></div><div class="resizer resizer-ne"></div><div class="resizer resizer-e"></div>
          <div class="resizer resizer-se"></div><div class="resizer resizer-s"></div><div class="resizer resizer-sw"></div>
          <div class="resizer resizer-w"></div><div class="resizer resizer-nw"></div>
        </div>

        <!-- Notepad Window -->
        <div class="window" id="notepad-window">
            <div class="title-bar">
                <img src="icons/All [Without duplicates]/Notepad.ico" alt="Icon" class="title-bar-icon">
                <span id="notepad-title">Untitled - Notepad</span> <!-- Title fixed -->
                <div class="window-controls">
                    <button class="minimize-button button-border-raised">ˍ</button>
                    <button class="maximize-button button-border-raised">□</button>
                    <button class="close-button button-border-raised">✕</button>
                </div>
            </div>
            <div class="menu-bar"><div class="menu-item"><u>F</u>ile</div><div class="menu-item"><u>E</u>dit</div><div class="menu-item"><u>S</u>earch</div><div class="menu-item"><u>H</u>elp</div></div>
            <div class="content" style="padding:0; margin:0; border: none;"><textarea class="notepad-textarea" spellcheck="false"></textarea></div>
            <div class="resizer resizer-n"></div><div class="resizer resizer-ne"></div><div class="resizer resizer-e"></div>
            <div class="resizer resizer-se"></div><div class="resizer resizer-s"></div><div class="resizer resizer-sw"></div>
            <div class="resizer resizer-w"></div><div class="resizer resizer-nw"></div>
        </div>

        <!-- Minesweeper Game Window -->
        <div class="window" id="minesweeper-window">
            <div class="title-bar">
                <img src="icons/All [Without duplicates]/Game.ico" alt="Icon" class="title-bar-icon">
                <span>Minesweeper</span> <!-- Title fixed -->
                <div class="window-controls">
                    <button class="minimize-button button-border-raised">ˍ</button>
                    <!-- No Maximize for fixed size game -->
                    <button class="close-button button-border-raised">✕</button>
                </div>
            </div>
             <div class="menu-bar">
                <div class="menu-item" onclick="minesweeper.newGame()"><u>G</u>ame</div>
                <div class="menu-item"><u>H</u>elp</div>
            </div>
            <div class="content minesweeper-content">
                <div class="minesweeper-info button-border-sunken">
                    <div class="minesweeper-mines-left" id="mines-left">10</div>
                    <div class="minesweeper-face" id="minesweeper-face">😊</div>
                    <div class="minesweeper-timer" id="minesweeper-timer">0</div>
                </div>
                <div class="minesweeper-grid button-border-sunken" id="minesweeper-grid">
                    <!-- Grid generated by JS -->
                </div>
            </div>
            <!-- No resizers for fixed size game window -->
        </div>

        <!-- Screen Saver Window -->
        <div class="window" id="screensaver-window">
            <div class="title-bar">
                <img src="icons/All [Without duplicates]/Desktop.ico" alt="Icon" class="title-bar-icon">
                <span>3D Flying Objects (Wedding Edition)</span>
                <div class="window-controls"><button class="close-button button-border-raised">✕</button></div> <!-- Only close -->
            </div>
            <div class="content screensaver-content">
                <div class="flying-object">💍</div><div class="flying-object">💖</div><div class="flying-object">🥂</div><div class="flying-object">🎂</div><div class="flying-object">🎉</div>
                <p style="position:absolute; bottom:10px; left:10px; color:rgba(255,255,255,0.5); font-size:10px;">Click or press any key to exit</p>
            </div>
        </div>

        <!-- Control Panel Window -->
        <div class="window" id="controlpanel-window">
          <div class="title-bar">
            <img src="icons/All [Without duplicates]/Controls.ico" alt="Icon" class="title-bar-icon">
            <span>Control Panel</span>
            <div class="window-controls">
              <button class="minimize-button button-border-raised">ˍ</button>
              <button class="maximize-button button-border-raised">□</button>
              <button class="close-button button-border-raised">✕</button>
            </div>
          </div>
          <div class="content">
            <div class="folder-grid"> <!-- Items trigger openExplorerWindow via JS -->
                <div class="folder-item" data-opens-explorer="display-props" data-explorer-title="Display Properties" data-explorer-icon="icons/All [Without duplicates]/Desktop.ico"><img src="icons/All [Without duplicates]/Desktop.ico" alt="Icon"><div>Display</div></div>
                <div class="folder-item" data-opens-explorer="printers" data-explorer-title="Printers" data-explorer-icon="icons/All [Without duplicates]/Printer (3D).ico"><img src="icons/All [Without duplicates]/Printer (3D).ico" alt="Icon"><div>Printers</div></div>
                <div class="folder-item" data-opens-explorer="mouse-settings" data-explorer-title="Mouse Properties" data-explorer-icon="icons/All [Without duplicates]/Mouse.ico"><img src="icons/All [Without duplicates]/Mouse.ico" alt="Icon"><div>Mouse</div></div>
                 <div class="folder-item" data-opens-explorer="sound-settings" data-explorer-title="Sounds" data-explorer-icon="icons/All [Without duplicates]/Sound program.ico"><img src="icons/All [Without duplicates]/Sound program.ico" alt="Icon"><div>Sounds</div></div>
                 <div class="folder-item" data-opens-explorer="add-remove-programs" data-explorer-title="Add/Remove Programs" data-explorer-icon="icons/All [Without duplicates]/Program group.ico"><img src="icons/All [Without duplicates]/Program group.ico" alt="Icon"><div>Add/Remove Programs</div></div>
            </div>
          </div>
          <div class="resizer resizer-n"></div><div class="resizer resizer-ne"></div><div class="resizer resizer-e"></div>
          <div class="resizer resizer-se"></div><div class="resizer resizer-s"></div><div class="resizer resizer-sw"></div>
          <div class="resizer resizer-w"></div><div class="resizer resizer-nw"></div>
        </div>

        <!-- Sound Control Placeholder Window -->
        <div class="window" id="sound-control-window" style="width:250px; height:200px;"> <!-- Adjusted size -->
            <div class="title-bar">
                <img src="icons/All [Without duplicates]/Sound program.ico" alt="Icon" class="title-bar-icon">
                <span>Volume Control</span>
                <div class="window-controls">
                    <button class="minimize-button button-border-raised">ˍ</button>
                    <button class="close-button button-border-raised">✕</button>
                </div>
            </div>
            <div class="content" style="padding:10px;">
                <p>Volume</p>
                <div style="display:flex; align-items:center; margin-bottom:10px;">
                    <span style="font-size:10px; margin-right:5px;">Low</span>
                    <input type="range" min="0" max="100" value="75" style="flex-grow:1;">
                    <span style="font-size:10px; margin-left:5px;">High</span>
                </div>
                <input type="checkbox" id="sound-mute"> <label for="sound-mute" style="font-size:11px;">Mute all</label>
                <hr style="margin:15px 0;">
                <p style="font-size:10px; text-align:center;">(Simulation Only! Adjusting has no effect.)</p>
            </div>
             <div class="resizer resizer-n"></div><div class="resizer resizer-ne"></div><div class="resizer resizer-e"></div>
            <div class="resizer resizer-se"></div><div class="resizer resizer-s"></div><div class="resizer resizer-sw"></div>
            <div class="resizer resizer-w"></div><div class="resizer resizer-nw"></div>
        </div>


        <!-- Taskbar -->
        <div class="taskbar">
            <button class="start-button button-border-raised" id="start-button">
                <img src="icons/All [Without duplicates]/Windows logo (without text).ico" alt="Win95 Logo">Start
            </button>
            <div id="window-buttons-container"></div>
            <div class="tray">
                <div class="sound-tray-icon" id="sound-tray-icon-clickable" title="Volume">
                    <img src="icons/All [Without duplicates]/Sound program.ico" alt="Sound Icon">
                </div>
                <div class="clock" id="clock">12:00</div>
            </div>
        </div>

        <!-- Start Menu (initially hidden) -->
        <div class="start-menu" id="start-menu">
            <div class="start-menu-sidebar"><span>Wedding 95</span></div>
            <div class="start-menu-items">
                <ul>
                    <li class="has-submenu"><img src="icons/All [Without duplicates]/Programs.ico" alt=""><span><u>P</u>rograms</span>
                        <ul>
                            <li><a href="#" onclick="openWindow('notepad-window')"><img src="icons/All [Without duplicates]/Notepad.ico" alt=""><span>Notepad</span></a></li>
                            <li><a href="#" onclick="openWindow('minesweeper-window')"><img src="icons/All [Without duplicates]/Game.ico" alt=""><span>Minesweeper</span></a></li>
                            <li><a href="#" onclick="openWindow('ie-widget')"><img src="icons/explorer.png" alt=""><span>Internet Fun</span></a></li>
                            <li class="separator"><hr></li>
                            <li><a href="#" onclick="openWindow('screensaver-window')"><img src="icons/All [Without duplicates]/Desktop.ico" alt=""><span>Screensaver</span></a></li>
                        </ul>
                    </li>
                    <li class="has-submenu"><img src="icons/All [Without duplicates]/Folder.ico" alt=""><span><u>D</u>ocuments</span>
                        <ul>
                            <li><a href="#" onclick="openWindow('invitation-window')"><img src="icons/All [Without duplicates]/Document with phone.ico" alt=""><span>Invitation.txt</span></a></li>
                            <li><a href="#" onclick="openWindow('folder-window')"><img src="icons/All [Without duplicates]/Folder.ico" alt=""><span>Photo Album</span></a></li>
                        </ul>
                    </li>
                    <li class="has-submenu"><img src="icons/All [Without duplicates]/Settings.ico" alt=""><span><u>S</u>ettings</span>
                        <ul>
                            <li><a href="#" onclick="openWindow('controlpanel-window')"><img src="icons/All [Without duplicates]/Controls.ico" alt=""><span>Control Panel</span></a></li>
                            <li><a href="#" onclick="openExplorerWindow('Printers', 'Printers', 'icons/All [Without duplicates]/Printer (3D).ico', state.explorerWindowContents['printers'].items)"><img src="icons/All [Without duplicates]/Printer (3D).ico" alt=""><span>Printers</span></a></li>
                        </ul>
                    </li>
                    <li><a href="#" onclick="alert('Find function is still searching for itself since 1998.')"><img src="icons/All [Without duplicates]/Search folder.ico" alt=""><span><u>F</u>ind</span></a></li>
                    <li><a href="#" onclick="openWindow('help-window')"><img src="icons/All [Without duplicates]/Help page.ico" alt=""><span><u>H</u>elp</span></a></li>
                    <li><a href="#" onclick="alert('Run command disabled. System integrity is paramount (and fragile).')"><img src="icons/All [Without duplicates]/Run.ico" alt=""><span><u>R</u>un...</span></a></li>
                    <li class="separator"><hr></li>
                    <li><a href="#" onclick="if(confirm('Are you sure you want to shut down your wedding experience?')) { document.body.innerHTML = '<div style=font-family:Tahoma,sans-serif;font-size:24px;text-align:center;padding-top:100px;color:white;background:black;height:100vh;>It\\\'s now safe to turn off your computer. <br><br> Thanks for celebrating with us!</div>'; };"><img src="icons/All [Without duplicates]/Turn Off Computer (full).ico" alt=""><span>Sh<u>u</u>t Down...</span></a></li>
                </ul>
            </div>
        </div>

        <!-- Right-click Context Menu (initially hidden) -->
        <div id="context-menu"></div>
    </div> <!-- End of .desktop -->

    <!-- Mobile Overlay - Shown only on mobile, hides most icons -->
    <div class="mobile-overlay" id="mobile-overlay">
         <div class="icon" id="mobile-invitation-icon" data-window-id="invitation-window">
            <img src="icons/All [Without duplicates]/Document with phone.ico" alt="Invitation Icon" class="icon-img">
            <div>View Invitation</div>
        </div>
         <div class="icon" id="mobile-upload-icon" data-window-id="upload-window">
            <img src="icons/All [Without duplicates]/Upload cloud.ico" alt="Upload Icon" class="icon-img">
            <div>Send Media</div>
        </div>
        <p class="mobile-info">Tap an icon to open.<br>(Desktop version has more features!)</p>
    </div>

    <script src="script.js"></script>
</body>
</html>